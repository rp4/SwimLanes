{"version":3,"file":"index-C61lEBvI.js","sources":["../../src/core/utils/parser.js","../../src/components/diagram/SwimLane.js","../../src/lib/export/exporter.js","../../src/components/editor/Editor.js","../../src/components/controls/Controls.js","../../src/core/services/KeyboardManager.js","../../src/core/services/UrlParamsHandler.js","../../src/app.js"],"sourcesContent":["export class ProcessParser {\n    constructor() {\n        this.defaultNodeTypes = ['start', 'process', 'decision', 'end'];\n        this.nodeIcons = {\n            start: '🏁',\n            process: '🏊',\n            decision: '🤿',\n            end: '🏆'\n        };\n    }\n\n    validateJSON(jsonData) {\n        const errors = [];\n        \n        if (!jsonData) {\n            errors.push('JSON data is empty');\n            return { valid: false, errors };\n        }\n\n        if (!jsonData.lanes || !Array.isArray(jsonData.lanes)) {\n            errors.push('JSON must contain a \"lanes\" array');\n        } else {\n            jsonData.lanes.forEach((lane, index) => {\n                if (!lane.id) {\n                    errors.push(`Lane at index ${index} missing \"id\" property`);\n                }\n                if (!lane.name) {\n                    errors.push(`Lane at index ${index} missing \"name\" property`);\n                }\n                if (lane.nodes && !Array.isArray(lane.nodes)) {\n                    errors.push(`Lane \"${lane.name || index}\" has invalid \"nodes\" property`);\n                } else if (lane.nodes) {\n                    lane.nodes.forEach((node, nodeIndex) => {\n                        if (!node.id) {\n                            errors.push(`Node at index ${nodeIndex} in lane \"${lane.name || index}\" missing \"id\" property`);\n                        }\n                        if (!node.text) {\n                            errors.push(`Node at index ${nodeIndex} in lane \"${lane.name || index}\" missing \"text\" property`);\n                        }\n                    });\n                }\n            });\n        }\n\n        if (jsonData.connections && !Array.isArray(jsonData.connections)) {\n            errors.push('Connections must be an array');\n        } else if (jsonData.connections) {\n            jsonData.connections.forEach((conn, index) => {\n                if (!conn.from) {\n                    errors.push(`Connection at index ${index} missing \"from\" property`);\n                }\n                if (!conn.to) {\n                    errors.push(`Connection at index ${index} missing \"to\" property`);\n                }\n            });\n        }\n\n        return {\n            valid: errors.length === 0,\n            errors\n        };\n    }\n\n    parseProcess(jsonData) {\n        const validation = this.validateJSON(jsonData);\n        if (!validation.valid) {\n            throw new Error('Invalid JSON: ' + validation.errors.join(', '));\n        }\n\n        const process = {\n            title: jsonData.title || 'Untitled Process',\n            lanes: [],\n            connections: jsonData.connections || [],\n            metadata: jsonData.metadata || {}\n        };\n\n        jsonData.lanes.forEach((lane, laneIndex) => {\n            const parsedLane = {\n                id: lane.id || `lane_${laneIndex}`,\n                name: lane.name || `Lane ${laneIndex + 1}`,\n                color: lane.color || this.generateLaneColor(laneIndex),\n                nodes: [],\n                position: lane.position || { y: laneIndex * 150 + 50 },\n                height: lane.height || 140\n            };\n\n            if (lane.nodes) {\n                lane.nodes.forEach((node, nodeIndex) => {\n                    parsedLane.nodes.push(this.parseNode(node, nodeIndex, laneIndex));\n                });\n            }\n\n            process.lanes.push(parsedLane);\n        });\n\n        return process;\n    }\n\n    parseNode(node, nodeIndex, laneIndex) {\n        const defaultPosition = {\n            x: nodeIndex * 200 + 150,\n            y: laneIndex * 150 + 100\n        };\n\n        return {\n            id: node.id || `node_${laneIndex}_${nodeIndex}`,\n            text: node.text || 'Node',\n            type: node.type || 'process',\n            position: node.position || defaultPosition,\n            color: node.color || this.getNodeColor(node.type),\n            icon: this.nodeIcons[node.type] || '🏊',\n            metadata: node.metadata || {}\n        };\n    }\n\n    generateLaneColor(index) {\n        const colors = [\n            '#64b5f6',\n            '#4fc3f7', \n            '#29b6f6',\n            '#03a9f4',\n            '#039be5',\n            '#0288d1'\n        ];\n        return colors[index % colors.length];\n    }\n\n    getNodeColor(type) {\n        const colors = {\n            start: '#4caf50',\n            process: '#2196f3',\n            decision: '#ff9800',\n            end: '#f44336'\n        };\n        return colors[type] || '#2196f3';\n    }\n\n    loadFromFile(file) {\n        return new Promise((resolve, reject) => {\n            const reader = new FileReader();\n            \n            reader.onload = (e) => {\n                try {\n                    const jsonData = JSON.parse(e.target.result);\n                    const processData = this.parseProcess(jsonData);\n                    resolve(processData);\n                } catch (error) {\n                    reject(new Error('Failed to parse JSON: ' + error.message));\n                }\n            };\n\n            reader.onerror = () => {\n                reject(new Error('Failed to read file'));\n            };\n\n            reader.readAsText(file);\n        });\n    }\n\n    generateSampleProcess() {\n        return {\n            title: 'Sample Swimming Pool Maintenance Process',\n            lanes: [\n                {\n                    id: 'lane_1',\n                    name: 'Pool Owner',\n                    color: '#64b5f6',\n                    nodes: [\n                        {\n                            id: 'node_1',\n                            text: 'Notice Pool Issues',\n                            type: 'start',\n                            position: { x: 100, y: 50 }\n                        },\n                        {\n                            id: 'node_2',\n                            text: 'Submit Request',\n                            type: 'process',\n                            position: { x: 300, y: 50 }\n                        },\n                        {\n                            id: 'node_7',\n                            text: 'Approve Work',\n                            type: 'decision',\n                            position: { x: 700, y: 50 }\n                        }\n                    ]\n                },\n                {\n                    id: 'lane_2',\n                    name: 'Pool Service',\n                    color: '#4fc3f7',\n                    nodes: [\n                        {\n                            id: 'node_3',\n                            text: 'Receive Request',\n                            type: 'process',\n                            position: { x: 300, y: 200 }\n                        },\n                        {\n                            id: 'node_4',\n                            text: 'Inspect Pool',\n                            type: 'process',\n                            position: { x: 500, y: 200 }\n                        },\n                        {\n                            id: 'node_5',\n                            text: 'Perform Service',\n                            type: 'process',\n                            position: { x: 700, y: 200 }\n                        }\n                    ]\n                },\n                {\n                    id: 'lane_3',\n                    name: 'Quality Check',\n                    color: '#29b6f6',\n                    nodes: [\n                        {\n                            id: 'node_6',\n                            text: 'Test Water Quality',\n                            type: 'process',\n                            position: { x: 900, y: 350 }\n                        },\n                        {\n                            id: 'node_8',\n                            text: 'Complete',\n                            type: 'end',\n                            position: { x: 1100, y: 350 }\n                        }\n                    ]\n                }\n            ],\n            connections: [\n                { from: 'node_1', to: 'node_2', label: 'Report' },\n                { from: 'node_2', to: 'node_3', label: 'Request' },\n                { from: 'node_3', to: 'node_4', label: 'Schedule' },\n                { from: 'node_4', to: 'node_5', label: 'Issues Found' },\n                { from: 'node_5', to: 'node_7', label: 'Review' },\n                { from: 'node_7', to: 'node_6', label: 'Approved' },\n                { from: 'node_6', to: 'node_8', label: 'Pass' }\n            ]\n        };\n    }\n}\n\nwindow.ProcessParser = ProcessParser;","export class SwimLaneRenderer {\n    constructor(svgElement) {\n        this.svg = svgElement;\n        this.swimlanesGroup = this.svg.querySelector('#swimlanes');\n        this.nodesGroup = this.svg.querySelector('#nodes');\n        this.connectionsGroup = this.svg.querySelector('#connections');\n        this.scale = 1;\n        this.translateX = 0;\n        this.translateY = 0;\n        this.processData = null;\n        this.selectedNode = null;\n        this.selectedLane = null;\n        \n        this.setupArrowMarker();\n    }\n\n    setupArrowMarker() {\n        const defs = this.svg.querySelector('defs');\n        const marker = document.createElementNS('http://www.w3.org/2000/svg', 'marker');\n        marker.setAttribute('id', 'arrowhead');\n        marker.setAttribute('markerWidth', '10');\n        marker.setAttribute('markerHeight', '10');\n        marker.setAttribute('refX', '9');\n        marker.setAttribute('refY', '3');\n        marker.setAttribute('orient', 'auto');\n        \n        const polygon = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');\n        polygon.setAttribute('points', '0 0, 10 3, 0 6');\n        polygon.setAttribute('fill', '#1565c0');\n        \n        marker.appendChild(polygon);\n        defs.appendChild(marker);\n    }\n    \n    createLaneRope(laneGroup, yPosition) {\n        const ropeGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n        \n        // Create rope floats\n        for (let x = 20; x <= 1420; x += 20) {\n            const float = document.createElementNS('http://www.w3.org/2000/svg', 'circle');\n            float.setAttribute('cx', x);\n            float.setAttribute('cy', yPosition);\n            float.setAttribute('r', '6');\n            \n            // Alternate colors for rope floats\n            if ((x / 20) % 3 === 0) {\n                float.classList.add('lane-rope-blue');\n            } else if ((x / 20) % 3 === 1) {\n                float.classList.add('lane-rope');\n            } else {\n                float.classList.add('lane-rope-yellow');\n            }\n            \n            ropeGroup.appendChild(float);\n        }\n        \n        // Add connecting line\n        const ropeLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');\n        ropeLine.setAttribute('x1', '20');\n        ropeLine.setAttribute('y1', yPosition);\n        ropeLine.setAttribute('x2', '1420');\n        ropeLine.setAttribute('y2', yPosition);\n        ropeLine.classList.add('lane-divider');\n        ropeGroup.appendChild(ropeLine);\n        \n        laneGroup.appendChild(ropeGroup);\n    }\n    \n    addDepthMarkers() {\n        const depths = ['3FT', '5FT', '8FT', '12FT'];\n        const positions = [200, 500, 900, 1300];\n        \n        depths.forEach((depth, index) => {\n            const marker = document.createElementNS('http://www.w3.org/2000/svg', 'text');\n            marker.setAttribute('x', positions[index]);\n            marker.setAttribute('y', '25');\n            marker.classList.add('depth-marker');\n            marker.textContent = depth;\n            this.swimlanesGroup.appendChild(marker);\n        });\n    }\n\n    render(processData) {\n        this.processData = processData;\n        this.clear();\n        this.renderSwimLanes();\n        this.renderNodes();\n        this.renderConnections();\n        this.fitToScreen();\n    }\n\n    clear() {\n        this.swimlanesGroup.innerHTML = '';\n        this.nodesGroup.innerHTML = '';\n        this.connectionsGroup.innerHTML = '';\n    }\n\n    renderSwimLanes() {\n        let currentY = 50;\n        \n        // Add pool edge at the top\n        const poolEdge = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n        poolEdge.setAttribute('x', '10');\n        poolEdge.setAttribute('y', '30');\n        poolEdge.setAttribute('width', '1420');\n        poolEdge.setAttribute('height', '10');\n        poolEdge.classList.add('pool-edge');\n        poolEdge.style.fill = '#e0e0e0';\n        this.swimlanesGroup.appendChild(poolEdge);\n        \n        // Add depth markers\n        this.addDepthMarkers();\n        \n        this.processData.lanes.forEach((lane, index) => {\n            const laneGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n            laneGroup.setAttribute('data-lane-id', lane.id);\n            laneGroup.classList.add('lane-group');\n            \n            // Add water effect background for each lane\n            const waterRect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n            waterRect.setAttribute('x', '20');\n            waterRect.setAttribute('y', currentY);\n            waterRect.setAttribute('width', '1400');\n            waterRect.setAttribute('height', lane.height || 140);\n            waterRect.setAttribute('rx', '2');\n            waterRect.setAttribute('ry', '2');\n            waterRect.style.fill = 'url(#waterGradient)';\n            waterRect.style.opacity = '0.3';\n            waterRect.classList.add('water-flow');\n            laneGroup.appendChild(waterRect);\n            \n            const laneRect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n            laneRect.setAttribute('x', '20');\n            laneRect.setAttribute('y', currentY);\n            laneRect.setAttribute('width', '1400');\n            laneRect.setAttribute('height', lane.height || 140);\n            laneRect.setAttribute('rx', '2');\n            laneRect.setAttribute('ry', '2');\n            laneRect.classList.add('swimlane');\n            laneRect.style.fill = lane.color + '20';\n            laneRect.style.stroke = lane.color;\n            laneRect.style.filter = 'url(#poolReflection)';\n            \n            // Add starting block\n            const startBlock = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n            startBlock.setAttribute('x', '5');\n            startBlock.setAttribute('y', currentY + (lane.height || 140) / 2 - 20);\n            startBlock.setAttribute('width', '15');\n            startBlock.setAttribute('height', '40');\n            startBlock.classList.add('starting-block');\n            laneGroup.appendChild(startBlock);\n            \n            const blockNumber = document.createElementNS('http://www.w3.org/2000/svg', 'text');\n            blockNumber.setAttribute('x', '12');\n            blockNumber.setAttribute('y', currentY + (lane.height || 140) / 2 + 5);\n            blockNumber.classList.add('starting-block-number');\n            blockNumber.textContent = index + 1;\n            laneGroup.appendChild(blockNumber);\n            \n            const laneLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');\n            laneLabel.setAttribute('x', '40');\n            laneLabel.setAttribute('y', currentY + 30);\n            laneLabel.classList.add('lane-label');\n            laneLabel.textContent = lane.name;\n            \n            if (index > 0) {\n                // Create floating lane rope divider\n                this.createLaneRope(laneGroup, currentY - 5);\n            }\n            \n            const resizeHandle = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n            resizeHandle.setAttribute('x', '1415');\n            resizeHandle.setAttribute('y', currentY + (lane.height || 140) / 2 - 20);\n            resizeHandle.setAttribute('width', '10');\n            resizeHandle.setAttribute('height', '40');\n            resizeHandle.classList.add('resize-handle');\n            resizeHandle.setAttribute('data-lane-id', lane.id);\n            \n            laneGroup.appendChild(laneRect);\n            laneGroup.appendChild(laneLabel);\n            laneGroup.appendChild(resizeHandle);\n            \n            this.swimlanesGroup.appendChild(laneGroup);\n            \n            lane.y = currentY;\n            currentY += (lane.height || 140) + 10;\n        });\n        \n        // Add pool edge at the bottom\n        const poolEdgeBottom = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n        poolEdgeBottom.setAttribute('x', '10');\n        poolEdgeBottom.setAttribute('y', currentY);\n        poolEdgeBottom.setAttribute('width', '1420');\n        poolEdgeBottom.setAttribute('height', '10');\n        poolEdgeBottom.classList.add('pool-edge');\n        poolEdgeBottom.style.fill = '#e0e0e0';\n        this.swimlanesGroup.appendChild(poolEdgeBottom);\n        \n        this.svg.setAttribute('viewBox', `0 0 1440 ${currentY + 50}`);\n    }\n\n    renderNodes() {\n        this.processData.lanes.forEach(lane => {\n            lane.nodes.forEach(node => {\n                const nodeGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n                nodeGroup.setAttribute('data-node-id', node.id);\n                nodeGroup.setAttribute('data-lane-id', lane.id);\n                nodeGroup.classList.add('process-node');\n                nodeGroup.style.cursor = 'move';\n                \n                let nodeShape;\n                const x = node.position.x;\n                const y = lane.y + 70;\n                \n                node.position.y = y;\n                \n                switch(node.type) {\n                    case 'start':\n                    case 'end':\n                        nodeShape = document.createElementNS('http://www.w3.org/2000/svg', 'circle');\n                        nodeShape.setAttribute('cx', x);\n                        nodeShape.setAttribute('cy', y);\n                        nodeShape.setAttribute('r', '35');\n                        break;\n                    case 'decision':\n                        nodeShape = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');\n                        const points = `${x},${y-35} ${x+35},${y} ${x},${y+35} ${x-35},${y}`;\n                        nodeShape.setAttribute('points', points);\n                        break;\n                    default:\n                        nodeShape = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n                        nodeShape.setAttribute('x', x - 50);\n                        nodeShape.setAttribute('y', y - 25);\n                        nodeShape.setAttribute('width', '100');\n                        nodeShape.setAttribute('height', '50');\n                        nodeShape.setAttribute('rx', '25');\n                        nodeShape.setAttribute('ry', '25');\n                        break;\n                }\n                \n                nodeShape.classList.add(`node-${node.type}`);\n                nodeShape.style.fill = node.color || this.getNodeColor(node.type);\n                nodeShape.style.stroke = 'white';\n                nodeShape.style.strokeWidth = '2';\n                \n                const nodeIcon = document.createElementNS('http://www.w3.org/2000/svg', 'text');\n                nodeIcon.setAttribute('x', x);\n                nodeIcon.setAttribute('y', y - 10);\n                nodeIcon.classList.add('node-text');\n                nodeIcon.style.fontSize = '20px';\n                nodeIcon.textContent = node.icon;\n                \n                const nodeText = document.createElementNS('http://www.w3.org/2000/svg', 'text');\n                nodeText.setAttribute('x', x);\n                nodeText.setAttribute('y', y + 10);\n                nodeText.classList.add('node-text');\n                nodeText.style.fontSize = '12px';\n                nodeText.textContent = node.text;\n                \n                nodeGroup.appendChild(nodeShape);\n                nodeGroup.appendChild(nodeIcon);\n                nodeGroup.appendChild(nodeText);\n                \n                this.nodesGroup.appendChild(nodeGroup);\n            });\n        });\n    }\n\n    renderConnections() {\n        this.processData.connections.forEach(conn => {\n            const fromNode = this.findNode(conn.from);\n            const toNode = this.findNode(conn.to);\n            \n            if (fromNode && toNode) {\n                const path = this.calculatePath(fromNode, toNode);\n                \n                const connectionPath = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n                connectionPath.setAttribute('d', path);\n                connectionPath.classList.add('connection-line');\n                connectionPath.setAttribute('marker-end', 'url(#arrowhead)');\n                connectionPath.setAttribute('data-from', conn.from);\n                connectionPath.setAttribute('data-to', conn.to);\n                \n                if (conn.label) {\n                    const midPoint = this.getPathMidpoint(fromNode, toNode);\n                    const label = document.createElementNS('http://www.w3.org/2000/svg', 'text');\n                    label.setAttribute('x', midPoint.x);\n                    label.setAttribute('y', midPoint.y - 5);\n                    label.classList.add('connection-label');\n                    label.textContent = conn.label;\n                    this.connectionsGroup.appendChild(label);\n                }\n                \n                this.connectionsGroup.appendChild(connectionPath);\n            }\n        });\n    }\n\n    calculatePath(fromNode, toNode) {\n        const fromX = fromNode.position.x;\n        const fromY = fromNode.position.y;\n        const toX = toNode.position.x;\n        const toY = toNode.position.y;\n        \n        const dx = toX - fromX;\n        const dy = toY - fromY;\n        \n        let startX = fromX;\n        let startY = fromY;\n        let endX = toX;\n        let endY = toY;\n        \n        if (Math.abs(dx) > Math.abs(dy)) {\n            startX += dx > 0 ? 35 : -35;\n            endX += dx > 0 ? -35 : 35;\n        } else {\n            startY += dy > 0 ? 35 : -35;\n            endY += dy > 0 ? -35 : 35;\n        }\n        \n        const controlX1 = startX + (endX - startX) * 0.5;\n        const controlY1 = startY;\n        const controlX2 = startX + (endX - startX) * 0.5;\n        const controlY2 = endY;\n        \n        return `M ${startX} ${startY} C ${controlX1} ${controlY1}, ${controlX2} ${controlY2}, ${endX} ${endY}`;\n    }\n\n    getPathMidpoint(fromNode, toNode) {\n        return {\n            x: (fromNode.position.x + toNode.position.x) / 2,\n            y: (fromNode.position.y + toNode.position.y) / 2\n        };\n    }\n\n    findNode(nodeId) {\n        for (const lane of this.processData.lanes) {\n            const node = lane.nodes.find(n => n.id === nodeId);\n            if (node) return node;\n        }\n        return null;\n    }\n\n    findLane(laneId) {\n        return this.processData.lanes.find(l => l.id === laneId);\n    }\n\n    getNodeColor(type) {\n        const colors = {\n            start: '#4caf50',\n            process: '#2196f3',\n            decision: '#ff9800',\n            end: '#f44336'\n        };\n        return colors[type] || '#2196f3';\n    }\n\n    fitToScreen() {\n        const bbox = this.svg.getBBox();\n        const viewBox = `${bbox.x - 20} ${bbox.y - 20} ${bbox.width + 40} ${bbox.height + 40}`;\n        this.svg.setAttribute('viewBox', viewBox);\n    }\n\n    zoom(factor) {\n        const viewBox = this.svg.getAttribute('viewBox') || '0 0 1440 800';\n        const [x, y, width, height] = viewBox.split(' ').map(Number);\n        \n        // Calculate the center point of the current view\n        const centerX = x + width / 2;\n        const centerY = y + height / 2;\n        \n        // Calculate new dimensions\n        const newWidth = width / factor;\n        const newHeight = height / factor;\n        \n        // Calculate new position to keep center point stable\n        const newX = centerX - newWidth / 2;\n        const newY = centerY - newHeight / 2;\n        \n        this.svg.setAttribute('viewBox', `${newX} ${newY} ${newWidth} ${newHeight}`);\n    }\n\n    pan(dx, dy) {\n        const viewBox = this.svg.getAttribute('viewBox') || '0 0 1440 800';\n        const [x, y, width, height] = viewBox.split(' ').map(Number);\n        \n        const newX = x - dx * (width / this.svg.clientWidth);\n        const newY = y - dy * (height / this.svg.clientHeight);\n        \n        this.svg.setAttribute('viewBox', `${newX} ${newY} ${width} ${height}`);\n    }\n\n    applyTransform() {\n        // This method is no longer needed as we're using viewBox directly\n        // Kept for backward compatibility\n    }\n\n    addLane(name) {\n        const newLane = {\n            id: `lane_${Date.now()}`,\n            name: name || `New Lane ${this.processData.lanes.length + 1}`,\n            color: this.generateLaneColor(this.processData.lanes.length),\n            nodes: [],\n            height: 140\n        };\n        \n        this.processData.lanes.push(newLane);\n        this.render(this.processData);\n        return newLane;\n    }\n\n    addNode(laneId, type = 'process', text = 'New Node') {\n        const lane = this.findLane(laneId);\n        if (!lane) return null;\n        \n        const newNode = {\n            id: `node_${Date.now()}`,\n            text: text,\n            type: type,\n            position: {\n                x: 150 + lane.nodes.length * 200,\n                y: lane.y + 70\n            },\n            color: this.getNodeColor(type),\n            icon: this.getNodeIcon(type)\n        };\n        \n        lane.nodes.push(newNode);\n        this.render(this.processData);\n        return newNode;\n    }\n\n    getNodeIcon(type) {\n        const icons = {\n            start: '🏁',\n            process: '🏊',\n            decision: '🤿',\n            end: '🏆'\n        };\n        return icons[type] || '🏊';\n    }\n\n    generateLaneColor(index) {\n        const colors = [\n            '#64b5f6',\n            '#4fc3f7',\n            '#29b6f6',\n            '#03a9f4',\n            '#039be5',\n            '#0288d1'\n        ];\n        return colors[index % colors.length];\n    }\n\n    updateNode(nodeId, updates) {\n        const node = this.findNode(nodeId);\n        if (node) {\n            Object.assign(node, updates);\n            this.render(this.processData);\n        }\n    }\n\n    deleteNode(nodeId) {\n        for (const lane of this.processData.lanes) {\n            const index = lane.nodes.findIndex(n => n.id === nodeId);\n            if (index !== -1) {\n                lane.nodes.splice(index, 1);\n                this.processData.connections = this.processData.connections.filter(\n                    conn => conn.from !== nodeId && conn.to !== nodeId\n                );\n                this.render(this.processData);\n                return true;\n            }\n        }\n        return false;\n    }\n\n    deleteLane(laneId) {\n        const index = this.processData.lanes.findIndex(l => l.id === laneId);\n        if (index !== -1) {\n            const lane = this.processData.lanes[index];\n            const nodeIds = lane.nodes.map(n => n.id);\n            this.processData.connections = this.processData.connections.filter(\n                conn => !nodeIds.includes(conn.from) && !nodeIds.includes(conn.to)\n            );\n            this.processData.lanes.splice(index, 1);\n            this.render(this.processData);\n            return true;\n        }\n        return false;\n    }\n\n    addConnection(fromId, toId, label = '') {\n        const connection = {\n            from: fromId,\n            to: toId,\n            label: label\n        };\n        this.processData.connections.push(connection);\n        this.render(this.processData);\n        return connection;\n    }\n\n    getProcessData() {\n        return this.processData;\n    }\n}\n\nwindow.SwimLaneRenderer = SwimLaneRenderer;","export class ProcessExporter {\n    constructor() {\n        this.svgNamespace = 'http://www.w3.org/2000/svg';\n    }\n\n    exportToJSON(processData) {\n        const exportData = {\n            title: processData.title,\n            lanes: processData.lanes.map(lane => ({\n                id: lane.id,\n                name: lane.name,\n                color: lane.color,\n                height: lane.height,\n                nodes: lane.nodes.map(node => ({\n                    id: node.id,\n                    text: node.text,\n                    type: node.type,\n                    position: {\n                        x: node.position.x,\n                        y: node.position.y\n                    },\n                    color: node.color,\n                    metadata: node.metadata || {}\n                }))\n            })),\n            connections: processData.connections.map(conn => ({\n                from: conn.from,\n                to: conn.to,\n                label: conn.label || ''\n            })),\n            metadata: processData.metadata || {}\n        };\n\n        return JSON.stringify(exportData, null, 2);\n    }\n\n    downloadJSON(processData, filename = 'swimlane-process.json') {\n        const jsonString = this.exportToJSON(processData);\n        const blob = new Blob([jsonString], { type: 'application/json' });\n        this.downloadFile(blob, filename);\n    }\n\n    exportToImage(svgElement, format = 'png', filename = 'swimlane-diagram') {\n        const svgClone = svgElement.cloneNode(true);\n        \n        this.addStyleToSVG(svgClone);\n        \n        const svgString = new XMLSerializer().serializeToString(svgClone);\n        const svgBlob = new Blob([svgString], { type: 'image/svg+xml;charset=utf-8' });\n        \n        if (format === 'svg') {\n            this.downloadFile(svgBlob, `${filename}.svg`);\n        } else if (format === 'png') {\n            this.convertSVGToPNG(svgString, filename);\n        }\n    }\n\n    addStyleToSVG(svgElement) {\n        const style = document.createElementNS(this.svgNamespace, 'style');\n        style.textContent = `\n            .swimlane {\n                fill: url(#laneGradient);\n                stroke: #1976d2;\n                stroke-width: 2;\n                opacity: 0.8;\n            }\n            .lane-divider {\n                stroke: #ffc107;\n                stroke-width: 3;\n                stroke-dasharray: 10, 5;\n                opacity: 0.8;\n            }\n            .lane-label {\n                fill: #0d47a1;\n                font-size: 18px;\n                font-weight: bold;\n                text-anchor: middle;\n                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            }\n            .process-node {\n                cursor: move;\n            }\n            .node-start {\n                fill: #4caf50;\n                stroke: white;\n                stroke-width: 2;\n            }\n            .node-process {\n                fill: #2196f3;\n                stroke: white;\n                stroke-width: 2;\n            }\n            .node-decision {\n                fill: #ff9800;\n                stroke: white;\n                stroke-width: 2;\n            }\n            .node-end {\n                fill: #f44336;\n                stroke: white;\n                stroke-width: 2;\n            }\n            .node-text {\n                fill: white;\n                font-size: 14px;\n                text-anchor: middle;\n                font-weight: 500;\n                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            }\n            .connection-line {\n                stroke: #1565c0;\n                stroke-width: 2;\n                fill: none;\n            }\n            .connection-label {\n                fill: #0d47a1;\n                font-size: 12px;\n                text-anchor: middle;\n                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            }\n        `;\n        svgElement.insertBefore(style, svgElement.firstChild);\n    }\n\n    convertSVGToPNG(svgString, filename) {\n        const img = new Image();\n        const url = 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(svgString);\n        \n        img.onload = () => {\n            const canvas = document.createElement('canvas');\n            const scale = 2;\n            canvas.width = img.width * scale;\n            canvas.height = img.height * scale;\n            \n            const ctx = canvas.getContext('2d');\n            ctx.fillStyle = 'white';\n            ctx.fillRect(0, 0, canvas.width, canvas.height);\n            ctx.scale(scale, scale);\n            ctx.drawImage(img, 0, 0);\n            \n            canvas.toBlob(blob => {\n                this.downloadFile(blob, `${filename}.png`);\n            }, 'image/png');\n        };\n        \n        img.src = url;\n    }\n\n    downloadFile(blob, filename) {\n        const url = URL.createObjectURL(blob);\n        const link = document.createElement('a');\n        link.href = url;\n        link.download = filename;\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n        URL.revokeObjectURL(url);\n    }\n\n    exportToPDF(svgElement, processData, filename = 'swimlane-diagram.pdf') {\n        alert('PDF export requires additional libraries. For now, please use PNG or SVG export and convert to PDF using external tools.');\n    }\n\n    exportToCSV(processData, filename = 'process-data.csv') {\n        const rows = [['Lane', 'Node ID', 'Node Text', 'Node Type', 'Position X', 'Position Y']];\n        \n        processData.lanes.forEach(lane => {\n            lane.nodes.forEach(node => {\n                rows.push([\n                    lane.name,\n                    node.id,\n                    node.text,\n                    node.type,\n                    node.position.x,\n                    node.position.y\n                ]);\n            });\n        });\n        \n        const csvContent = rows.map(row => row.map(cell => `\"${cell}\"`).join(',')).join('\\n');\n        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n        this.downloadFile(blob, filename);\n    }\n\n    copyToClipboard(processData) {\n        const jsonString = this.exportToJSON(processData);\n        \n        if (navigator.clipboard && navigator.clipboard.writeText) {\n            navigator.clipboard.writeText(jsonString).then(() => {\n                this.showNotification('Process data copied to clipboard!');\n            }).catch(err => {\n                console.error('Failed to copy to clipboard:', err);\n                this.fallbackCopyToClipboard(jsonString);\n            });\n        } else {\n            this.fallbackCopyToClipboard(jsonString);\n        }\n    }\n\n    fallbackCopyToClipboard(text) {\n        const textArea = document.createElement('textarea');\n        textArea.value = text;\n        textArea.style.position = 'fixed';\n        textArea.style.top = '0';\n        textArea.style.left = '0';\n        textArea.style.opacity = '0';\n        \n        document.body.appendChild(textArea);\n        textArea.focus();\n        textArea.select();\n        \n        try {\n            const successful = document.execCommand('copy');\n            if (successful) {\n                this.showNotification('Process data copied to clipboard!');\n            } else {\n                this.showNotification('Failed to copy to clipboard', 'error');\n            }\n        } catch (err) {\n            console.error('Fallback copy failed:', err);\n            this.showNotification('Failed to copy to clipboard', 'error');\n        }\n        \n        document.body.removeChild(textArea);\n    }\n\n    showNotification(message, type = 'success') {\n        const notification = document.createElement('div');\n        notification.textContent = message;\n        notification.style.cssText = `\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            padding: 15px 20px;\n            background: ${type === 'success' ? '#4caf50' : '#f44336'};\n            color: white;\n            border-radius: 5px;\n            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n            z-index: 10000;\n            animation: slideIn 0.3s ease;\n        `;\n        \n        document.body.appendChild(notification);\n        \n        setTimeout(() => {\n            notification.style.animation = 'slideOut 0.3s ease';\n            setTimeout(() => {\n                document.body.removeChild(notification);\n            }, 300);\n        }, 3000);\n    }\n\n    generateShareableLink(processData) {\n        const jsonString = this.exportToJSON(processData);\n        const compressed = btoa(encodeURIComponent(jsonString));\n        const currentUrl = window.location.origin + window.location.pathname;\n        const shareUrl = `${currentUrl}?data=${compressed}`;\n        \n        if (shareUrl.length > 2000) {\n            this.showNotification('Process too large for URL sharing. Please use file export.', 'error');\n            return null;\n        }\n        \n        return shareUrl;\n    }\n}\n\nconst style = document.createElement('style');\nstyle.textContent = `\n    @keyframes slideIn {\n        from {\n            transform: translateX(100%);\n            opacity: 0;\n        }\n        to {\n            transform: translateX(0);\n            opacity: 1;\n        }\n    }\n    \n    @keyframes slideOut {\n        from {\n            transform: translateX(0);\n            opacity: 1;\n        }\n        to {\n            transform: translateX(100%);\n            opacity: 0;\n        }\n    }\n`;\ndocument.head.appendChild(style);\n\nwindow.ProcessExporter = ProcessExporter;","export class DiagramEditor {\n    constructor(renderer) {\n        this.renderer = renderer;\n        this.svg = renderer.svg;\n        this.isDragging = false;\n        this.draggedNode = null;\n        this.dragOffset = { x: 0, y: 0 };\n        this.isConnecting = false;\n        this.connectionStart = null;\n        this.connectionPreview = null;\n        this.history = [];\n        this.historyIndex = -1;\n        this.maxHistory = 50;\n        \n        this.setupEventListeners();\n    }\n\n    setupEventListeners() {\n        this.svg.addEventListener('mousedown', this.handleMouseDown.bind(this));\n        this.svg.addEventListener('mousemove', this.handleMouseMove.bind(this));\n        this.svg.addEventListener('mouseup', this.handleMouseUp.bind(this));\n        this.svg.addEventListener('dblclick', this.handleDoubleClick.bind(this));\n        \n        document.addEventListener('keydown', this.handleKeyDown.bind(this));\n    }\n\n    getSVGPoint(e) {\n        const rect = this.svg.getBoundingClientRect();\n        const viewBox = this.svg.getAttribute('viewBox');\n        \n        if (viewBox) {\n            const [vx, vy, vw, vh] = viewBox.split(' ').map(Number);\n            const scaleX = vw / rect.width;\n            const scaleY = vh / rect.height;\n            \n            return {\n                x: vx + (e.clientX - rect.left) * scaleX,\n                y: vy + (e.clientY - rect.top) * scaleY\n            };\n        } else {\n            const point = this.svg.createSVGPoint();\n            point.x = e.clientX - rect.left;\n            point.y = e.clientY - rect.top;\n            const svgPoint = point.matrixTransform(this.svg.getScreenCTM().inverse());\n            return { x: svgPoint.x, y: svgPoint.y };\n        }\n    }\n\n    handleMouseDown(e) {\n        const target = e.target.closest('.process-node');\n        if (target && !this.isConnecting) {\n            this.startDragging(e, target);\n        } else if (target && this.isConnecting) {\n            this.completeConnection(target.getAttribute('data-node-id'));\n        }\n        \n        const resizeHandle = e.target.closest('.resize-handle');\n        if (resizeHandle) {\n            this.startResizing(e, resizeHandle);\n        }\n    }\n\n    handleMouseMove(e) {\n        if (this.isDragging && this.draggedNode) {\n            this.dragNode(e);\n        } else if (this.isConnecting && this.connectionPreview) {\n            this.updateConnectionPreview(e);\n        } else if (this.isResizing) {\n            this.resizeLane(e);\n        }\n    }\n\n    handleMouseUp(e) {\n        if (this.isDragging) {\n            this.stopDragging();\n        } else if (this.isResizing) {\n            this.stopResizing();\n        }\n    }\n\n    handleDoubleClick(e) {\n        const nodeElement = e.target.closest('.process-node');\n        if (nodeElement) {\n            const nodeId = nodeElement.getAttribute('data-node-id');\n            this.editNode(nodeId);\n        }\n        \n        const laneElement = e.target.closest('.swimlane');\n        if (laneElement && !nodeElement) {\n            const laneId = laneElement.parentElement.getAttribute('data-lane-id');\n            this.editLane(laneId);\n        }\n    }\n\n    handleKeyDown(e) {\n        if (e.ctrlKey || e.metaKey) {\n            switch(e.key) {\n                case 'z':\n                    e.preventDefault();\n                    this.undo();\n                    break;\n                case 'y':\n                    e.preventDefault();\n                    this.redo();\n                    break;\n                case 's':\n                    e.preventDefault();\n                    this.save();\n                    break;\n            }\n        }\n        \n        if (e.key === 'Delete' && this.renderer.selectedNode) {\n            this.deleteSelectedNode();\n        }\n    }\n\n    startDragging(e, nodeElement) {\n        this.saveState();\n        this.isDragging = true;\n        this.draggedNode = nodeElement;\n        const nodeId = nodeElement.getAttribute('data-node-id');\n        const node = this.renderer.findNode(nodeId);\n        \n        const svgPoint = this.getSVGPoint(e);\n        \n        this.dragOffset = {\n            x: svgPoint.x - node.position.x,\n            y: svgPoint.y - node.position.y\n        };\n        \n        nodeElement.classList.add('node-dragging');\n    }\n\n    dragNode(e) {\n        if (!this.draggedNode) return;\n        \n        const nodeId = this.draggedNode.getAttribute('data-node-id');\n        const node = this.renderer.findNode(nodeId);\n        \n        const svgPoint = this.getSVGPoint(e);\n        \n        node.position.x = svgPoint.x - this.dragOffset.x;\n        node.position.y = svgPoint.y - this.dragOffset.y;\n        \n        const laneId = this.getLaneAtPosition(node.position.y);\n        if (laneId && laneId !== this.draggedNode.getAttribute('data-lane-id')) {\n            this.moveNodeToLane(nodeId, laneId);\n        }\n        \n        this.renderer.render(this.renderer.processData);\n        \n        const newDraggedNode = this.svg.querySelector(`[data-node-id=\"${nodeId}\"]`);\n        if (newDraggedNode) {\n            newDraggedNode.classList.add('node-dragging');\n            this.draggedNode = newDraggedNode;\n        }\n    }\n\n    stopDragging() {\n        if (this.draggedNode) {\n            this.draggedNode.classList.remove('node-dragging');\n        }\n        this.isDragging = false;\n        this.draggedNode = null;\n        this.dragOffset = { x: 0, y: 0 };\n    }\n\n    getLaneAtPosition(y) {\n        for (const lane of this.renderer.processData.lanes) {\n            if (y >= lane.y && y <= lane.y + (lane.height || 140)) {\n                return lane.id;\n            }\n        }\n        return null;\n    }\n\n    moveNodeToLane(nodeId, newLaneId) {\n        const processData = this.renderer.processData;\n        let node = null;\n        let oldLaneId = null;\n        \n        for (const lane of processData.lanes) {\n            const nodeIndex = lane.nodes.findIndex(n => n.id === nodeId);\n            if (nodeIndex !== -1) {\n                node = lane.nodes[nodeIndex];\n                oldLaneId = lane.id;\n                lane.nodes.splice(nodeIndex, 1);\n                break;\n            }\n        }\n        \n        if (node) {\n            const newLane = processData.lanes.find(l => l.id === newLaneId);\n            if (newLane) {\n                newLane.nodes.push(node);\n            }\n        }\n    }\n\n    startConnecting(fromNodeId) {\n        this.isConnecting = true;\n        this.connectionStart = fromNodeId;\n        \n        const fromNode = this.renderer.findNode(fromNodeId);\n        if (fromNode) {\n            this.connectionPreview = document.createElementNS('http://www.w3.org/2000/svg', 'line');\n            this.connectionPreview.classList.add('connection-preview');\n            this.connectionPreview.setAttribute('x1', fromNode.position.x);\n            this.connectionPreview.setAttribute('y1', fromNode.position.y);\n            this.connectionPreview.setAttribute('x2', fromNode.position.x);\n            this.connectionPreview.setAttribute('y2', fromNode.position.y);\n            this.renderer.connectionsGroup.appendChild(this.connectionPreview);\n        }\n    }\n\n    updateConnectionPreview(e) {\n        if (!this.connectionPreview) return;\n        \n        const rect = this.svg.getBoundingClientRect();\n        const viewBox = this.svg.getAttribute('viewBox');\n        \n        if (viewBox) {\n            const [vx, vy, vw, vh] = viewBox.split(' ').map(Number);\n            const scaleX = vw / rect.width;\n            const scaleY = vh / rect.height;\n            \n            const x = vx + (e.clientX - rect.left) * scaleX;\n            const y = vy + (e.clientY - rect.top) * scaleY;\n            \n            this.connectionPreview.setAttribute('x2', x);\n            this.connectionPreview.setAttribute('y2', y);\n        } else {\n            const point = this.svg.createSVGPoint();\n            point.x = e.clientX - rect.left;\n            point.y = e.clientY - rect.top;\n            \n            const svgPoint = point.matrixTransform(this.svg.getScreenCTM().inverse());\n            \n            this.connectionPreview.setAttribute('x2', svgPoint.x);\n            this.connectionPreview.setAttribute('y2', svgPoint.y);\n        }\n    }\n\n    completeConnection(toNodeId) {\n        if (this.connectionStart && toNodeId && this.connectionStart !== toNodeId) {\n            this.saveState();\n            const label = prompt('Enter connection label (optional):');\n            this.renderer.addConnection(this.connectionStart, toNodeId, label || '');\n        }\n        \n        this.cancelConnection();\n    }\n\n    cancelConnection() {\n        this.isConnecting = false;\n        this.connectionStart = null;\n        if (this.connectionPreview) {\n            this.connectionPreview.remove();\n            this.connectionPreview = null;\n        }\n    }\n\n    editNode(nodeId) {\n        const node = this.renderer.findNode(nodeId);\n        if (!node) return;\n        \n        const modal = document.getElementById('nodeModal');\n        const nodeText = document.getElementById('nodeText');\n        const nodeType = document.getElementById('nodeType');\n        const nodeColor = document.getElementById('nodeColor');\n        \n        nodeText.value = node.text;\n        nodeType.value = node.type;\n        nodeColor.value = node.color || this.renderer.getNodeColor(node.type);\n        \n        modal.style.display = 'flex';\n        this.renderer.selectedNode = nodeId;\n        \n        const saveBtn = document.getElementById('saveNodeBtn');\n        const deleteBtn = document.getElementById('deleteNodeBtn');\n        const cancelBtn = document.getElementById('cancelNodeBtn');\n        const closeBtn = modal.querySelector('.close-btn');\n        \n        const saveHandler = () => {\n            this.saveState();\n            this.renderer.updateNode(nodeId, {\n                text: nodeText.value,\n                type: nodeType.value,\n                color: nodeColor.value,\n                icon: this.renderer.getNodeIcon(nodeType.value)\n            });\n            modal.style.display = 'none';\n            this.cleanup();\n        };\n        \n        const deleteHandler = () => {\n            if (confirm('Are you sure you want to delete this node?')) {\n                this.saveState();\n                this.renderer.deleteNode(nodeId);\n                modal.style.display = 'none';\n                this.cleanup();\n            }\n        };\n        \n        const cancelHandler = () => {\n            modal.style.display = 'none';\n            this.cleanup();\n        };\n        \n        const cleanup = () => {\n            saveBtn.removeEventListener('click', saveHandler);\n            deleteBtn.removeEventListener('click', deleteHandler);\n            cancelBtn.removeEventListener('click', cancelHandler);\n            closeBtn.removeEventListener('click', cancelHandler);\n            this.renderer.selectedNode = null;\n        };\n        \n        this.cleanup = cleanup;\n        \n        saveBtn.addEventListener('click', saveHandler);\n        deleteBtn.addEventListener('click', deleteHandler);\n        cancelBtn.addEventListener('click', cancelHandler);\n        closeBtn.addEventListener('click', cancelHandler);\n    }\n\n    editLane(laneId) {\n        const lane = this.renderer.findLane(laneId);\n        if (!lane) return;\n        \n        const modal = document.getElementById('laneModal');\n        const laneName = document.getElementById('laneName');\n        const laneColor = document.getElementById('laneColor');\n        \n        laneName.value = lane.name;\n        laneColor.value = lane.color;\n        \n        modal.style.display = 'flex';\n        this.renderer.selectedLane = laneId;\n        \n        const saveBtn = document.getElementById('saveLaneBtn');\n        const deleteBtn = document.getElementById('deleteLaneBtn');\n        const cancelBtn = document.getElementById('cancelLaneBtn');\n        const closeBtn = modal.querySelector('.close-btn');\n        \n        const saveHandler = () => {\n            this.saveState();\n            lane.name = laneName.value;\n            lane.color = laneColor.value;\n            this.renderer.render(this.renderer.processData);\n            modal.style.display = 'none';\n            this.cleanup();\n        };\n        \n        const deleteHandler = () => {\n            if (confirm('Are you sure you want to delete this lane and all its nodes?')) {\n                this.saveState();\n                this.renderer.deleteLane(laneId);\n                modal.style.display = 'none';\n                this.cleanup();\n            }\n        };\n        \n        const cancelHandler = () => {\n            modal.style.display = 'none';\n            this.cleanup();\n        };\n        \n        const cleanup = () => {\n            saveBtn.removeEventListener('click', saveHandler);\n            deleteBtn.removeEventListener('click', deleteHandler);\n            cancelBtn.removeEventListener('click', cancelHandler);\n            closeBtn.removeEventListener('click', cancelHandler);\n            this.renderer.selectedLane = null;\n        };\n        \n        this.cleanup = cleanup;\n        \n        saveBtn.addEventListener('click', saveHandler);\n        deleteBtn.addEventListener('click', deleteHandler);\n        cancelBtn.addEventListener('click', cancelHandler);\n        closeBtn.addEventListener('click', cancelHandler);\n    }\n\n    startResizing(e, handle) {\n        this.isResizing = true;\n        this.resizingLane = handle.getAttribute('data-lane-id');\n        this.resizeStartX = e.clientX;\n        this.resizeStartHeight = this.renderer.findLane(this.resizingLane).height || 140;\n    }\n\n    resizeLane(e) {\n        if (!this.isResizing) return;\n        \n        const lane = this.renderer.findLane(this.resizingLane);\n        if (lane) {\n            const diff = e.clientX - this.resizeStartX;\n            lane.height = Math.max(100, this.resizeStartHeight + diff);\n            this.renderer.render(this.renderer.processData);\n        }\n    }\n\n    stopResizing() {\n        this.isResizing = false;\n        this.resizingLane = null;\n    }\n\n    saveState() {\n        const state = JSON.stringify(this.renderer.processData);\n        \n        if (this.historyIndex < this.history.length - 1) {\n            this.history = this.history.slice(0, this.historyIndex + 1);\n        }\n        \n        this.history.push(state);\n        \n        if (this.history.length > this.maxHistory) {\n            this.history.shift();\n        } else {\n            this.historyIndex++;\n        }\n    }\n\n    undo() {\n        if (this.historyIndex > 0) {\n            this.historyIndex--;\n            const state = JSON.parse(this.history[this.historyIndex]);\n            this.renderer.render(state);\n        }\n    }\n\n    redo() {\n        if (this.historyIndex < this.history.length - 1) {\n            this.historyIndex++;\n            const state = JSON.parse(this.history[this.historyIndex]);\n            this.renderer.render(state);\n        }\n    }\n\n    save() {\n        const event = new CustomEvent('save', { detail: this.renderer.processData });\n        document.dispatchEvent(event);\n    }\n\n    deleteSelectedNode() {\n        if (this.renderer.selectedNode) {\n            this.saveState();\n            this.renderer.deleteNode(this.renderer.selectedNode);\n            this.renderer.selectedNode = null;\n        }\n    }\n}\n\nwindow.DiagramEditor = DiagramEditor;","export class DiagramControls {\n    constructor(renderer, editor, parser, exporter) {\n        this.renderer = renderer;\n        this.editor = editor;\n        this.parser = parser;\n        this.exporter = exporter;\n        this.connectMode = false;\n        \n        this.setupControls();\n        this.setupDragAndDrop();\n    }\n\n    setupControls() {\n        document.getElementById('uploadBtn').addEventListener('click', () => {\n            document.getElementById('fileInput').click();\n        });\n\n        document.getElementById('fileInput').addEventListener('change', (e) => {\n            this.handleFileUpload(e.target.files[0]);\n        });\n\n        document.getElementById('loadSampleBtn').addEventListener('click', () => {\n            this.loadSampleData();\n        });\n\n        document.getElementById('addLaneBtn').addEventListener('click', () => {\n            this.addNewLane();\n        });\n\n        document.getElementById('addNodeBtn').addEventListener('click', () => {\n            this.addNewNode();\n        });\n\n        document.getElementById('connectBtn').addEventListener('click', () => {\n            this.toggleConnectMode();\n        });\n\n        document.getElementById('zoomInBtn').addEventListener('click', () => {\n            this.renderer.zoom(1.2);\n        });\n\n        document.getElementById('zoomOutBtn').addEventListener('click', () => {\n            this.renderer.zoom(0.8);\n        });\n\n        document.getElementById('fitBtn').addEventListener('click', () => {\n            this.renderer.fitToScreen();\n        });\n\n        document.getElementById('undoBtn').addEventListener('click', () => {\n            this.editor.undo();\n        });\n\n        document.getElementById('redoBtn').addEventListener('click', () => {\n            this.editor.redo();\n        });\n\n        document.getElementById('downloadJsonBtn').addEventListener('click', () => {\n            this.downloadJSON();\n        });\n\n        document.getElementById('downloadImageBtn').addEventListener('click', () => {\n            this.downloadImage();\n        });\n\n        document.addEventListener('save', (e) => {\n            this.exporter.downloadJSON(e.detail);\n        });\n    }\n\n    setupDragAndDrop() {\n        const dropZone = document.getElementById('dropZone');\n        const swimlaneCanvas = document.getElementById('swimlaneCanvas');\n\n        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {\n            dropZone.addEventListener(eventName, this.preventDefaults, false);\n            document.body.addEventListener(eventName, this.preventDefaults, false);\n        });\n\n        ['dragenter', 'dragover'].forEach(eventName => {\n            dropZone.addEventListener(eventName, () => {\n                dropZone.classList.add('drag-over');\n            }, false);\n        });\n\n        ['dragleave', 'drop'].forEach(eventName => {\n            dropZone.addEventListener(eventName, () => {\n                dropZone.classList.remove('drag-over');\n            }, false);\n        });\n\n        dropZone.addEventListener('drop', (e) => {\n            const files = e.dataTransfer.files;\n            if (files.length > 0) {\n                this.handleFileUpload(files[0]);\n            }\n        }, false);\n\n        dropZone.addEventListener('click', () => {\n            document.getElementById('fileInput').click();\n        });\n    }\n\n    preventDefaults(e) {\n        e.preventDefault();\n        e.stopPropagation();\n    }\n\n    async handleFileUpload(file) {\n        if (!file || !file.name.endsWith('.json')) {\n            alert('Please upload a valid JSON file');\n            return;\n        }\n\n        try {\n            const processData = await this.parser.loadFromFile(file);\n            this.displayDiagram(processData);\n            this.showNotification('Process loaded successfully!');\n        } catch (error) {\n            alert('Error loading file: ' + error.message);\n        }\n    }\n\n    loadSampleData() {\n        const sampleData = this.parser.generateSampleProcess();\n        this.displayDiagram(sampleData);\n        this.showNotification('Sample process loaded!');\n    }\n\n    displayDiagram(processData) {\n        document.getElementById('dropZone').style.display = 'none';\n        document.getElementById('swimlaneCanvas').style.display = 'block';\n        \n        this.renderer.render(processData);\n        this.editor.saveState();\n    }\n\n    addNewLane() {\n        const name = prompt('Enter lane name:');\n        if (name) {\n            this.editor.saveState();\n            const lane = this.renderer.addLane(name);\n            this.showNotification(`Lane \"${name}\" added!`);\n        }\n    }\n\n    addNewNode() {\n        if (!this.renderer.processData || this.renderer.processData.lanes.length === 0) {\n            alert('Please add a lane first or load a process');\n            return;\n        }\n\n        const lanes = this.renderer.processData.lanes;\n        const laneOptions = lanes.map(l => `${l.name}`).join('\\n');\n        const laneIndex = prompt(`Select lane (enter number):\\n${lanes.map((l, i) => `${i + 1}. ${l.name}`).join('\\n')}`);\n        \n        if (laneIndex && !isNaN(laneIndex)) {\n            const selectedLane = lanes[parseInt(laneIndex) - 1];\n            if (selectedLane) {\n                const nodeText = prompt('Enter node text:') || 'New Node';\n                const nodeType = prompt('Enter node type (start/process/decision/end):') || 'process';\n                \n                this.editor.saveState();\n                const node = this.renderer.addNode(selectedLane.id, nodeType, nodeText);\n                this.showNotification('Node added!');\n            }\n        }\n    }\n\n    toggleConnectMode() {\n        this.connectMode = !this.connectMode;\n        const connectBtn = document.getElementById('connectBtn');\n        \n        if (this.connectMode) {\n            connectBtn.style.background = 'linear-gradient(135deg, #ff9800 0%, #f57c00 100%)';\n            this.showNotification('Connection mode ON - Click nodes to connect them');\n            this.setupConnectionMode();\n        } else {\n            connectBtn.style.background = '';\n            this.showNotification('Connection mode OFF');\n            this.teardownConnectionMode();\n        }\n    }\n\n    setupConnectionMode() {\n        this.connectionHandler = (e) => {\n            const nodeElement = e.target.closest('.process-node');\n            if (nodeElement) {\n                const nodeId = nodeElement.getAttribute('data-node-id');\n                \n                if (!this.editor.connectionStart) {\n                    this.editor.startConnecting(nodeId);\n                    this.showNotification('Select target node');\n                } else {\n                    this.editor.completeConnection(nodeId);\n                    this.toggleConnectMode();\n                }\n            }\n        };\n        \n        this.renderer.svg.addEventListener('click', this.connectionHandler);\n    }\n\n    teardownConnectionMode() {\n        if (this.connectionHandler) {\n            this.renderer.svg.removeEventListener('click', this.connectionHandler);\n            this.connectionHandler = null;\n        }\n        this.editor.cancelConnection();\n    }\n\n    downloadJSON() {\n        const processData = this.renderer.getProcessData();\n        if (processData) {\n            const filename = prompt('Enter filename:', 'swimlane-process.json') || 'swimlane-process.json';\n            this.exporter.downloadJSON(processData, filename);\n            this.showNotification('JSON downloaded!');\n        } else {\n            alert('No diagram to export');\n        }\n    }\n\n    downloadImage() {\n        const processData = this.renderer.getProcessData();\n        if (!processData) {\n            alert('No diagram to export');\n            return;\n        }\n\n        const format = prompt('Enter format (png/svg):', 'png') || 'png';\n        const filename = prompt('Enter filename:', 'swimlane-diagram') || 'swimlane-diagram';\n        \n        this.exporter.exportToImage(this.renderer.svg, format, filename);\n        this.showNotification(`${format.toUpperCase()} downloaded!`);\n    }\n\n    showNotification(message, type = 'success') {\n        const notification = document.createElement('div');\n        notification.textContent = message;\n        notification.style.cssText = `\n            position: fixed;\n            bottom: 20px;\n            right: 20px;\n            padding: 15px 20px;\n            background: ${type === 'success' ? 'linear-gradient(135deg, #4caf50, #45a049)' : 'linear-gradient(135deg, #f44336, #da190b)'};\n            color: white;\n            border-radius: 25px;\n            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);\n            z-index: 10000;\n            animation: notificationSlide 0.3s ease;\n            font-weight: 500;\n        `;\n        \n        document.body.appendChild(notification);\n        \n        setTimeout(() => {\n            notification.style.animation = 'notificationFade 0.3s ease';\n            setTimeout(() => {\n                document.body.removeChild(notification);\n            }, 300);\n        }, 3000);\n    }\n}\n\nconst notificationStyle = document.createElement('style');\nnotificationStyle.textContent = `\n    @keyframes notificationSlide {\n        from {\n            transform: translateY(100%);\n            opacity: 0;\n        }\n        to {\n            transform: translateY(0);\n            opacity: 1;\n        }\n    }\n    \n    @keyframes notificationFade {\n        from {\n            opacity: 1;\n        }\n        to {\n            opacity: 0;\n        }\n    }\n`;\ndocument.head.appendChild(notificationStyle);\n\nwindow.DiagramControls = DiagramControls;","export class KeyboardManager {\n    constructor(app) {\n        this.app = app;\n    }\n\n    setupKeyboardShortcuts() {\n        document.addEventListener('keydown', (e) => {\n            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {\n                return;\n            }\n\n            if (e.ctrlKey || e.metaKey) {\n                this.handleCtrlShortcuts(e);\n            } else {\n                this.handleRegularShortcuts(e);\n            }\n        });\n    }\n\n    handleCtrlShortcuts(e) {\n        switch(e.key.toLowerCase()) {\n            case 'o':\n                e.preventDefault();\n                document.getElementById('fileInput')?.click();\n                break;\n            case 's':\n                e.preventDefault();\n                this.app.controls.downloadJSON();\n                break;\n            case 'e':\n                e.preventDefault();\n                this.app.controls.downloadImage();\n                break;\n            case 'l':\n                e.preventDefault();\n                this.app.controls.addNewLane();\n                break;\n            case 'n':\n                e.preventDefault();\n                this.app.controls.addNewNode();\n                break;\n            case '+':\n            case '=':\n                e.preventDefault();\n                this.app.renderer.zoom(1.2);\n                break;\n            case '-':\n            case '_':\n                e.preventDefault();\n                this.app.renderer.zoom(0.8);\n                break;\n            case '0':\n                e.preventDefault();\n                this.app.renderer.fitToScreen();\n                break;\n        }\n    }\n\n    handleRegularShortcuts(e) {\n        switch(e.key.toLowerCase()) {\n            case 'c':\n                if (!e.target.closest('input, textarea')) {\n                    this.app.controls.toggleConnectMode();\n                }\n                break;\n            case 'h':\n                this.showHelp();\n                break;\n            case 'escape':\n                this.app.editor.cancelConnection();\n                if (this.app.controls.connectMode) {\n                    this.app.controls.toggleConnectMode();\n                }\n                break;\n        }\n    }\n\n    showHelp() {\n        const helpText = `\n🏊 Swim Lane Diagram - Keyboard Shortcuts\n\nFile Operations:\n• Ctrl+O: Open file\n• Ctrl+S: Save as JSON\n• Ctrl+E: Export as image\n\nEditing:\n• Ctrl+L: Add new lane\n• Ctrl+N: Add new node\n• C: Toggle connection mode\n• Delete: Delete selected node\n• Ctrl+Z: Undo\n• Ctrl+Y: Redo\n\nView:\n• Ctrl+Plus: Zoom in\n• Ctrl+Minus: Zoom out\n• Ctrl+0: Fit to screen\n\nOther:\n• H: Show this help\n• Escape: Cancel current operation\n• Double-click node: Edit node\n• Double-click lane: Edit lane\n• Drag nodes to move them\n        `;\n        \n        alert(helpText);\n    }\n}","export class UrlParamsHandler {\n    constructor(app) {\n        this.app = app;\n    }\n\n    checkUrlParams() {\n        const urlParams = new URLSearchParams(window.location.search);\n        const data = urlParams.get('data');\n        \n        if (data) {\n            this.loadSharedDiagram(data);\n        }\n    }\n\n    loadSharedDiagram(data) {\n        try {\n            const jsonString = decodeURIComponent(atob(data));\n            const jsonData = JSON.parse(jsonString);\n            const processData = this.app.parser.parseProcess(jsonData);\n            this.app.controls.displayDiagram(processData);\n        } catch (error) {\n            console.error('Failed to load shared diagram:', error);\n            this.showErrorMessage('Failed to load shared diagram. The link may be corrupted.');\n        }\n    }\n\n    createShareableUrl(jsonData) {\n        const jsonString = JSON.stringify(jsonData);\n        const encodedData = btoa(encodeURIComponent(jsonString));\n        const baseUrl = window.location.origin + window.location.pathname;\n        return `${baseUrl}?data=${encodedData}`;\n    }\n\n    showErrorMessage(message) {\n        // This could be enhanced with a better UI notification system\n        console.error(message);\n        alert(message);\n    }\n}","import { ProcessParser } from './core/utils/parser.js';\nimport { SwimLaneRenderer } from './components/diagram/SwimLane.js';\nimport { ProcessExporter } from './lib/export/exporter.js';\nimport { DiagramEditor } from './components/editor/Editor.js';\nimport { DiagramControls } from './components/controls/Controls.js';\nimport { KeyboardManager } from './core/services/KeyboardManager.js';\nimport { UrlParamsHandler } from './core/services/UrlParamsHandler.js';\nimport './styles/base/main.css';\n\nclass SwimLaneApp {\n    constructor() {\n        this.svg = document.getElementById('diagramSvg');\n        this.parser = new ProcessParser();\n        this.renderer = new SwimLaneRenderer(this.svg);\n        this.exporter = new ProcessExporter();\n        this.editor = new DiagramEditor(this.renderer);\n        this.controls = new DiagramControls(this.renderer, this.editor, this.parser, this.exporter);\n        \n        this.keyboardManager = new KeyboardManager(this);\n        this.urlParamsHandler = new UrlParamsHandler(this);\n        \n        this.init();\n    }\n\n    init() {\n        this.urlParamsHandler.checkUrlParams();\n        this.keyboardManager.setupKeyboardShortcuts();\n        console.log('🏊 Swim Lane Diagram Visualizer initialized!');\n    }\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    const app = new SwimLaneApp();\n    window.swimLaneApp = app;\n});\n\nexport default SwimLaneApp;"],"names":["ProcessParser","constructor","this","defaultNodeTypes","nodeIcons","start","process","decision","end","validateJSON","jsonData","errors","lanes","Array","isArray","forEach","lane","index","id","push","concat","name","nodes","node","nodeIndex","text","connections","conn","from","to","valid","length","parseProcess","validation","Error","join","title","metadata","laneIndex","parsedLane","color","generateLaneColor","position","y","height","parseNode","defaultPosition","x","type","getNodeColor","icon","colors","loadFromFile","file","Promise","resolve","reject","reader","FileReader","onload","e","JSON","parse","target","result","processData","error","message","onerror","readAsText","generateSampleProcess","label","window","SwimLaneRenderer","svgElement","svg","swimlanesGroup","querySelector","nodesGroup","connectionsGroup","scale","translateX","translateY","selectedNode","selectedLane","setupArrowMarker","defs","marker","document","createElementNS","setAttribute","polygon","appendChild","createLaneRope","laneGroup","yPosition","ropeGroup","float","classList","add","ropeLine","addDepthMarkers","positions","depth","textContent","render","clear","renderSwimLanes","renderNodes","renderConnections","fitToScreen","innerHTML","currentY","poolEdge","style","fill","waterRect","opacity","laneRect","stroke","filter","startBlock","blockNumber","laneLabel","resizeHandle","poolEdgeBottom","nodeGroup","nodeShape","cursor","points","strokeWidth","nodeIcon","fontSize","nodeText","fromNode","findNode","toNode","path","calculatePath","connectionPath","midPoint","getPathMidpoint","fromX","fromY","toX","toY","dx","dy","startX","startY","endX","endY","Math","abs","controlX1","controlY1","controlX2","controlY2","nodeId","find","n","findLane","laneId","l","bbox","getBBox","viewBox","width","zoom","factor","getAttribute","split","map","Number","newWidth","newHeight","newX","newY","pan","clientWidth","clientHeight","applyTransform","addLane","newLane","Date","now","addNode","newNode","getNodeIcon","updateNode","updates","Object","assign","deleteNode","findIndex","splice","deleteLane","nodeIds","includes","addConnection","fromId","toId","connection","getProcessData","ProcessExporter","svgNamespace","exportToJSON","exportData","stringify","downloadJSON","filename","jsonString","blob","Blob","downloadFile","exportToImage","format","svgClone","cloneNode","addStyleToSVG","svgString","XMLSerializer","serializeToString","svgBlob","convertSVGToPNG","insertBefore","firstChild","img","Image","url","encodeURIComponent","canvas","createElement","ctx","getContext","fillStyle","fillRect","drawImage","toBlob","src","URL","createObjectURL","link","href","download","body","click","removeChild","revokeObjectURL","exportToPDF","alert","exportToCSV","rows","csvContent","row","cell","copyToClipboard","navigator","clipboard","writeText","then","showNotification","catch","err","fallbackCopyToClipboard","textArea","value","top","left","focus","select","execCommand","notification","cssText","setTimeout","animation","generateShareableLink","compressed","btoa","currentUrl","location","origin","pathname","shareUrl","head","DiagramEditor","renderer","isDragging","draggedNode","dragOffset","isConnecting","connectionStart","connectionPreview","history","historyIndex","maxHistory","setupEventListeners","addEventListener","handleMouseDown","bind","handleMouseMove","handleMouseUp","handleDoubleClick","handleKeyDown","getSVGPoint","rect","getBoundingClientRect","vx","vy","vw","vh","scaleX","scaleY","clientX","clientY","point","createSVGPoint","svgPoint","matrixTransform","getScreenCTM","inverse","closest","startDragging","completeConnection","startResizing","dragNode","updateConnectionPreview","isResizing","resizeLane","stopDragging","stopResizing","nodeElement","editNode","laneElement","parentElement","editLane","ctrlKey","metaKey","key","preventDefault","undo","redo","save","deleteSelectedNode","saveState","getLaneAtPosition","moveNodeToLane","newDraggedNode","remove","newLaneId","startConnecting","fromNodeId","toNodeId","prompt","cancelConnection","modal","getElementById","nodeType","nodeColor","display","saveBtn","deleteBtn","cancelBtn","closeBtn","saveHandler","cleanup","deleteHandler","confirm","cancelHandler","removeEventListener","laneName","laneColor","handle","resizingLane","resizeStartX","resizeStartHeight","diff","max","state","slice","shift","event","CustomEvent","detail","dispatchEvent","DiagramControls","editor","parser","exporter","connectMode","setupControls","setupDragAndDrop","handleFileUpload","files","loadSampleData","addNewLane","addNewNode","toggleConnectMode","downloadImage","dropZone","eventName","preventDefaults","dataTransfer","stopPropagation","endsWith","displayDiagram","sampleData","i","isNaN","parseInt","connectBtn","background","setupConnectionMode","teardownConnectionMode","connectionHandler","toUpperCase","notificationStyle","KeyboardManager","app","setupKeyboardShortcuts","tagName","handleCtrlShortcuts","handleRegularShortcuts","toLowerCase","_a","controls","showHelp","UrlParamsHandler","checkUrlParams","data","URLSearchParams","search","get","loadSharedDiagram","decodeURIComponent","atob","showErrorMessage","createShareableUrl","encodedData","baseUrl","SwimLaneApp","keyboardManager","urlParamsHandler","init","swimLaneApp"],"mappings":"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"}